# TESTING THE CHROMIUM BRANCH

# Download the Qt source release
https://download.qt.io/archive/qt/5.15/5.15.2/single/qt-everywhere-src-5.15.2.tar.xz

# Untar it
tar xf qt-everywhere-src-5.15.2.tar.xz

# Go to the chromium directory
cd qt-everywhere-src-5.15.2/qtwebengine/src/3rdparty/

# Move the chromium folder over
mv chromium chromium_orig

# Get the TurteBrowser Chromium
git clone git@github.com:turtlebrowser/chromium.git

# Get the right branch
cd chromium
git checkout turtlebrowser_integration_83.0.4103.122_qt_5.15.2
# git clone git@github.com:turtlebrowser/chromium.git --branch turtlebrowser_integration_83.0.4103.122_qt_5.15.2 --single-branch chromium

# Make a build directory
mkdir ../../../../qt5-build
cd ../../../../qt5-build

# Add in clang-11
sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-11 80
sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-11 80
sudo update-alternatives --install /usr/bin/clang clang /usr/lib/llvm-6.0/bin/clang 100
sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/lib/llvm-6.0/bin/clang++ 100

# Set compiler to clang-11
sudo update-alternatives --set clang /usr/bin/clang-11
sudo update-alternatives --set clang++ /usr/bin/clang++-11

# Configure qt for clang
../qt5/configure -platform linux-clang -developer-build -opensource -nomake examples -nomake tests
../qt-everywhere-src-5.15.2/configure -platform linux-clang -developer-build -opensource -nomake examples -nomake tests

# Build Qt
make -j 8
